# ============================================================
# AI-КОМПЛАЕНС АГЕНТ - КОНФИГУРАЦИЯ ДЛЯ ДЕПЛОЯ
# ============================================================
# Скопируйте этот файл в .env и заполните реальными значениями
# Никогда не коммитьте .env в репозиторий!

# ============================================================
# DJANGO CORE НАСТРОЙКИ
# ============================================================

# ОБЯЗАТЕЛЬНО: Секретный ключ Django (сгенерируйте уникальный для production)
# Генерация: python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
SECRET_KEY=your-secret-key-here-change-in-production

# Environment: development, production (default: production)
# Determines which settings file to load (dev.py or prod.py)
DJANGO_ENV=production

# Режим отладки (ВСЕГДА False в production!)
DEBUG=False

# Разрешенные хосты (укажите ваш домен)
# Формат: domain1.com,domain2.com,subdomain.domain.com
ALLOWED_HOSTS=localhost,127.0.0.1,.yourdomain.com

# ============================================================
# БАЗА ДАННЫХ (PostgreSQL)
# ============================================================

# ОБЯЗАТЕЛЬНО: URL подключения к PostgreSQL
# Формат: postgres://USER:PASSWORD@HOST:PORT/DATABASE_NAME
# Пример DigitalOcean: postgres://user:pass@db-postgresql-region-00000-do-user-0000000-0.db.ondigitalocean.com:25060/defaultdb?sslmode=require
DATABASE_URL=postgres://user:password@localhost:5432/ai_compliance_db

# ============================================================
# REDIS (Celery Broker & Cache)
# ============================================================

# ОБЯЗАТЕЛЬНО: URL подключения к Redis
# Формат: redis://[[username]:password@]host:port/db
# Пример DigitalOcean: rediss://default:password@redis-cluster-region-00000-do-user-0000000-0.db.ondigitalocean.com:25061
REDIS_URL=redis://localhost:6379/0

# ============================================================
# BACKBLAZE B2 ХРАНИЛИЩЕ
# ============================================================
# Получите ключи на: https://secure.backblaze.com/app_keys.htm

# ОБЯЗАТЕЛЬНО: Endpoint URL вашего Backblaze B2 региона
# Формат: https://s3.{region}.backblazeb2.com
# Примеры:
#   - US West: https://s3.us-west-000.backblazeb2.com
#   - EU Central: https://s3.eu-central-003.backblazeb2.com
BACKBLAZE_ENDPOINT_URL=https://s3.us-west-000.backblazeb2.com

# ОБЯЗАТЕЛЬНО: Application Key ID (похож на AWS Access Key)
BACKBLAZE_APPLICATION_KEY_ID=000abc123def4567890

# ОБЯЗАТЕЛЬНО: Application Key (похож на AWS Secret Key)
BACKBLAZE_APPLICATION_KEY=K000AbCdEfGhIjKlMnOpQrStUvWxYz1234567890

# ОБЯЗАТЕЛЬНО: Имя бакета B2 для хранения видео
BACKBLAZE_BUCKET_NAME=ai-compliance-videos

# ============================================================
# CLOUDFLARE CDN (Опционально, но рекомендуется)
# ============================================================
# Настройка Cloudflare CDN для бесплатного egress-трафика из B2
# Инструкция: https://www.backblaze.com/docs/cloud-storage-deliver-public-backblaze-b2-content-through-cloudflare-cdn

# URL вашего Cloudflare CDN для B2 бакета
# Формат: https://cdn.yourdomain.com или https://your-custom-domain.com
# Если не используете CDN, оставьте пустым
CLOUDFLARE_CDN_URL=https://cdn.yourdomain.com

# Cloudflare API токен (для программного управления CDN)
# Получите на: https://dash.cloudflare.com/profile/api-tokens
# Права: Zone:Read, Cache Purge
CLOUDFLARE_API_TOKEN=your_cloudflare_api_token_here

# Cloudflare Zone ID вашего домена
# Найдите в дашборде Cloudflare для вашего домена
CLOUDFLARE_ZONE_ID=your_zone_id_here

# ============================================================
# REPLICATE - AI INFERENCE API
# ============================================================
# Получите токен на: https://replicate.com/account/api-tokens

# ОБЯЗАТЕЛЬНО: Replicate API Token
REPLICATE_API_TOKEN=r8_your_replicate_api_token_here

# ============================================================
# AI МОДЕЛИ (Replicate Model IDs)
# ============================================================
# Не меняйте без необходимости - протестированные версии моделей

# Whisper ASR (Speech-to-Text) - Model: openai/whisper
# Используем small модель для баланса скорости/точности на русском языке
WHISPER_MODEL_ID=openai/whisper:4d50797290df275329f202e48c76360b3f22b08d28c196cbc54600319435f8d2

# YOLOv8 Object Detection - Model: yolov8
# Для детекции объектов (бутылки, сигареты, символы и т.д.)
YOLO_MODEL_ID=adirik/yolov8:fcb0173c3d6ef4e4e73ced22d0c6c3c7d0e5d3e5b5e5e5e5e5e5e5e5e5e5e5

# NSFW Content Detection - Model: Falconsai/nsfw_image_detection
# Детекция 18+ контента
NSFW_MODEL_ID=lucataco/nsfw-image-detection:02f0b7ae9c4c3d7e4e7d5f0e5c5d5e5f5e5e5e5e5e5e5e5e5e5e5e5e5e

# Violence/Gore Detection - Model: jaranohaal/vit-base-violence-detection
# Детекция жести, насилия, крови
VIOLENCE_MODEL_ID=lucataco/vit-violence-detection:01f0b7ae9c4c3d7e4e7d5f0e5c5d5e5f5e5e5e5e5e5e5e5e5e5e5e5e5e

# EasyOCR - Optical Character Recognition
# Распознавание текста в кадрах (в т.ч. русский язык)
OCR_MODEL_ID=abiruyt/text-extract-ocr:3e6e3e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e

# ============================================================
# EMAIL НАСТРОЙКИ
# ============================================================
# Для отправки уведомлений клиентам о готовности отчетов

# Email Backend (для production используйте SMTP)
# Варианты:
#   - django.core.mail.backends.smtp.EmailBackend (SMTP - рекомендуется)
#   - django.core.mail.backends.console.EmailBackend (вывод в консоль для разработки)
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend

# SMTP настройки (для реальной отправки email)
# Популярные провайдеры:
#   - Gmail: smtp.gmail.com:587
#   - SendGrid: smtp.sendgrid.net:587
#   - Mailgun: smtp.mailgun.org:587
#   - AWS SES: email-smtp.{region}.amazonaws.com:587
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True

# SMTP аутентификация
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-app-specific-password

# Отправитель по умолчанию
DEFAULT_FROM_EMAIL=noreply@yourdomain.com

# Адреса для уведомлений админов об ошибках
ADMIN_EMAIL=admin@yourdomain.com

# ============================================================
# ВРЕМЕННЫЕ ФАЙЛЫ
# ============================================================

# Директория для временных файлов (FFmpeg, загрузки)
# В production на DigitalOcean App Platform используйте /tmp
# Важно: App Platform очищает /tmp после рестартов
TEMP_DIR=/tmp

# ============================================================
# AI PIPELINE НАСТРОЙКИ
# ============================================================

# Максимальный размер загружаемого видео (в байтах)
# По умолчанию: 2GB (2147483648 байт)
MAX_VIDEO_FILE_SIZE=2147483648

# Максимальная длительность видео для обработки (в секундах)
# По умолчанию: 7200 секунд (2 часа)
MAX_VIDEO_DURATION=7200

# Частота извлечения кадров для анализа (кадров в секунду)
# По умолчанию: 1 (один кадр в секунду)
# Снижение этого значения ускорит обработку, но может пропустить короткие риски
FRAME_EXTRACTION_FPS=1

# Timeout для AI модели (секунды)
# Максимальное время ожидания ответа от Replicate API
REPLICATE_TIMEOUT=300

# ============================================================
# ЛОГИРОВАНИЕ
# ============================================================

# Уровень логирования
# Варианты: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Логировать SQL запросы (только для отладки!)
LOG_SQL_QUERIES=False

# ============================================================
# БЕЗОПАСНОСТЬ
# ============================================================

# HTTPS настройки (для production)
# Включите после настройки SSL сертификата
SECURE_SSL_REDIRECT=True
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True

# ============================================================
# CELERY НАСТРОЙКИ (Расширенные)
# ============================================================

# Количество воркеров Celery
# По умолчанию определяется автоматически по CPU
# CELERY_WORKER_CONCURRENCY=4

# Максимальное количество задач на воркер перед рестартом
CELERY_WORKER_MAX_TASKS_PER_CHILD=100

# Таймаут выполнения задачи (секунды)
CELERY_TASK_TIME_LIMIT=3600

# Таймаут soft (предупреждение перед завершением)
CELERY_TASK_SOFT_TIME_LIMIT=3300

# ============================================================
# СЛОВАРИ ДЛЯ NLP АНАЛИЗА (Опционально)
# ============================================================
# Пути к файлам со словарями для анализа текста/речи
# Если не указаны, используются встроенные словари

# Словарь матерных слов
# PROFANITY_DICT_PATH=/app/dictionaries/profanity_ru.txt

# Словарь брендов для детекции рекламы
# BRAND_DICT_PATH=/app/dictionaries/brands_ru.txt

# Словарь запрещенных слов (436-ФЗ, 20.3 КоАП)
# STOPWORDS_DICT_PATH=/app/dictionaries/stopwords_ru.txt

# ============================================================
# МОНИТОРИНГ (Опционально)
# ============================================================

# Sentry DSN для отслеживания ошибок
# Получите на: https://sentry.io
# SENTRY_DSN=https://examplePublicKey@o0.ingest.sentry.io/0

# ============================================================
# РАЗРАБОТКА (Только для локальной разработки!)
# ============================================================

# Для локальной разработки можно использовать упрощенные настройки:
# DEBUG=True
# DATABASE_URL=postgres://postgres:postgres@localhost:5432/ai_compliance_dev
# REDIS_URL=redis://localhost:6379/0
# EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend
# REPLICATE_API_TOKEN=dummy_token_for_testing
